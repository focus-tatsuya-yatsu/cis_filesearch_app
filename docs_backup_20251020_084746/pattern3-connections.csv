Connection_ID,From_Component,To_Component,Connection_Type,Label,Color,Style,Line_Width,Arrow_Type,Notes
BATCH_01,EventBridge,Step_Functions,Trigger,"① 月1回トリガー\ncron(0 2 1 * ? *)",#0066CC,Solid,3,Single,"バッチ開始トリガー"
BATCH_02,Step_Functions,VPNManager,Invoke,"② VPN接続開始\nInvoke Lambda",#0066CC,Solid,3,Single,"VPN制御Lambda起動"
BATCH_03,VPNManager,Virtual_Private_Gateway,VPN_Control,"③ VPN接続確立\nIPsec Tunnel",#0066CC,Dashed,2,Bidirectional,"VPN接続制御"
VPN_CONN,VPN_Router,Virtual_Private_Gateway,VPN_Tunnel,"⏰ 月4時間のみ\n2:00-6:00 (月1日)\n暗号化通信",#0066CC,Dashed,2,Bidirectional,"オンプレミス-AWS VPN接続"
BATCH_04,VPNManager,AWS_DataSync,Invoke,"④ DataSync起動\nStartTaskExecution",#0066CC,Solid,3,Single,"DataSync起動"
DATA_TRANSFER,NAS,S3_Bucket,Data_Sync,"⑤ 増分データ転送\n20GB/月\n転送時間: 約3時間\n100Mbps",#FF9900,Solid,4,Single,"NAS→DataSync Agent→VPN→DataSync→S3の経路"
BATCH_05,Step_Functions,VPNManager,Invoke,"⑥ VPN切断\n同期完了後",#0066CC,Solid,3,Single,"VPN切断指示"
BATCH_06,Step_Functions,FileScanner,Invoke,"⑦ S3スキャン開始\nVPN切断後",#0066CC,Solid,3,Single,"ファイルスキャン開始"
BATCH_07,FileScanner,S3_Bucket,S3_API,"⑧ メタデータ取得\nListObjectsV2",#00AA00,Solid,2,Bidirectional,"S3オブジェクトリスト取得"
BATCH_08,FileScanner,TextExtractor,Invoke,"⑨ テキスト抽出\n5,000 PDFs\n最大100並列",#0066CC,Solid,3,Single,"テキスト抽出Lambda起動"
BATCH_09,FileScanner,ImageFeatureExtractor,Invoke,"⑨ 画像特徴抽出\n2,000 Images\n最大50並列",#0066CC,Solid,3,Single,"画像特徴抽出Lambda起動"
BATCH_10,TextExtractor,S3_Bucket,S3_API,"⑩ 抽出テキスト保存\n/extracted-text/*.json",#00AA00,Solid,2,Bidirectional,"抽出テキスト保存"
BATCH_11,ImageFeatureExtractor,S3_Bucket,S3_API,"⑩ 特徴ベクトル保存\n/image-features/*.npy\n512次元",#00AA00,Solid,2,Bidirectional,"画像特徴量保存"
BATCH_12A,TextExtractor,BulkIndexer,Invoke,"⑪ 処理完了通知",#0066CC,Solid,3,Single,"テキスト抽出完了"
BATCH_12B,ImageFeatureExtractor,BulkIndexer,Invoke,"⑪ 処理完了通知",#0066CC,Solid,3,Single,"画像処理完了"
BATCH_13,BulkIndexer,S3_Bucket,S3_API,"⑫ 全データ取得",#00AA00,Solid,2,Single,"インデックス用データ取得"
BATCH_14,BulkIndexer,OpenSearch,Bulk_API,"⑬ Bulk API\nkuromoji + k-NN\nバッチサイズ: 1,000",#0066CC,Solid,3,Single,"OpenSearchインデックス登録"
BATCH_15,BulkIndexer,DynamoDB,DynamoDB_API,"⑭ メタデータ更新\nBatchWriteItem",#0066CC,Solid,3,Single,"DynamoDBメタデータ更新"
BATCH_16,BulkIndexer,SNS,SNS_Publish,"⑮ 完了通知\n成功/失敗ステータス",#0066CC,Solid,3,Single,"バッチ完了通知"
SEARCH_01,User,NextJS_Frontend,HTTPS,"HTTPS\nAzure AD認証",#00AA00,Solid,2,Bidirectional,"ユーザーアクセス"
SEARCH_02,NextJS_Frontend,SearchAPI,REST_API,"POST /api/search\n{query: '提案書'}",#00AA00,Solid,2,Bidirectional,"検索クエリ送信"
SEARCH_03,SearchAPI,OpenSearch,Search_Query,"全文検索\nkuromoji tokenizer",#00AA00,Solid,2,Bidirectional,"OpenSearch検索"
SEARCH_04,SearchAPI,DynamoDB,DynamoDB_Query,"GetItem\nfile_metadata",#00AA00,Solid,2,Bidirectional,"メタデータ取得"
SEARCH_05,SearchAPI,S3_Bucket,S3_API,"GetObject\nハイライト用",#00AA00,Solid,2,Bidirectional,"テキストスニペット取得"
MONITOR_01,VPNManager,CloudWatch,Logs,"Logs/Metrics",#00BCD4,Dotted,1,Single,"Lambda監視ログ"
MONITOR_02,FileScanner,CloudWatch,Logs,"Logs/Metrics",#00BCD4,Dotted,1,Single,"Lambda監視ログ"
MONITOR_03,TextExtractor,CloudWatch,Logs,"Logs/Metrics",#00BCD4,Dotted,1,Single,"Lambda監視ログ"
MONITOR_04,ImageFeatureExtractor,CloudWatch,Logs,"Logs/Metrics",#00BCD4,Dotted,1,Single,"Lambda監視ログ"
MONITOR_05,BulkIndexer,CloudWatch,Logs,"Logs/Metrics",#00BCD4,Dotted,1,Single,"Lambda監視ログ"
MONITOR_06,SearchAPI,CloudWatch,Logs,"Logs/Metrics",#00BCD4,Dotted,1,Single,"Lambda監視ログ"
