# CIS ファイル検索システム プロジェクトロードマップ

## 1. プロジェクト概要

### 1.1 目標
- 社内NAS上の膨大なファイルを効率的に検索できるシステムの構築
- 画像類似検索などの先進的な機能の実装
- 50名以上の同時利用に耐えうるスケーラブルなアーキテクチャ

### 1.2 開発期間
- **総期間**: 8ヶ月
- **開始予定**: 2025年2月
- **本番稼働**: 2025年9月

## 2. フェーズ別計画

### Phase 1: 基本機能実装（3ヶ月）

**期間**: 2025年2月 - 2025年4月

#### 目標
- 基本的な検索機能の実装
- ユーザー認証基盤の構築
- シンプルで使いやすいUIの提供

#### 主要タスク

**Month 1: インフラ構築**
- [ ] AWS環境のセットアップ
  - VPC、サブネット、セキュリティグループ設定
  - RDS (PostgreSQL) セットアップ
  - OpenSearch クラスター構築
- [ ] 開発環境の構築
  - Docker開発環境
  - CI/CDパイプライン（GitHub Actions）
- [ ] プロジェクト初期化
  - Next.js プロジェクト作成
  - 基本的なディレクトリ構造
  - ESLint、Prettier設定

**Month 2: 認証とコア機能**
- [ ] 認証システム
  - AWS Cognito統合
  - JWT認証実装
  - ログイン/ログアウト機能
- [ ] ファイル名検索
  - 基本的な検索UI
  - ファイル名での検索機能
  - ページネーション
- [ ] ファイル一覧表示
  - ファイルリスト表示
  - ファイルメタデータ表示

**Month 3: UI改善とテスト**
- [ ] UIコンポーネント整備
  - デザインシステム構築
  - レスポンシブ対応
  - アクセシビリティ対応
- [ ] テスト実装
  - ユニットテスト（80%カバレッジ）
  - 統合テスト
  - E2Eテスト（主要フロー）
- [ ] ベータ版リリース

**成果物**
- 基本的な検索機能を持つMVP
- ユーザー認証システム
- 初期テストスイート

### Phase 2: 高度な機能実装（2ヶ月）

**期間**: 2025年5月 - 2025年6月

#### 目標
- 全文検索機能の実装
- 特殊ファイル形式（SFC、Docuworks）への対応
- 高度なフィルタリング機能

#### 主要タスク

**Month 4: 全文検索**
- [ ] OpenSearch最適化
  - 日本語アナライザー設定
  - インデックス設計
  - 検索クエリ最適化
- [ ] ファイル処理パイプライン
  - PDF テキスト抽出
  - Office文書 テキスト抽出
  - 画像OCR（オプション）
- [ ] 検索結果のハイライト
  - キーワードハイライト
  - スニペット表示

**Month 5: 特殊ファイル対応**
- [ ] SFCファイル対応
  - SFCパーサー実装
  - テキスト抽出処理
- [ ] Docuworks対応
  - Docuworks API連携
  - テキスト抽出
- [ ] 詳細フィルタ機能
  - ファイルタイプフィルタ
  - 日付範囲フィルタ
  - サイズフィルタ
  - フォルダパスフィルタ

**成果物**
- 全文検索機能
- SFC/Docuworks対応
- 高度なフィルタリング

### Phase 3: AI機能実装（2ヶ月）

**期間**: 2025年7月 - 2025年8月

#### 目標
- 画像類似検索の実装
- 検索精度の向上
- レコメンド機能

#### 主要タスク

**Month 6: 画像類似検索**
- [ ] 画像ベクトル化
  - 画像特徴量抽出（ResNet/ViT）
  - ベクトルインデックス作成
- [ ] 類似画像検索API
  - アップロード機能
  - 類似度計算
  - 検索結果表示
- [ ] サムネイル生成
  - 自動サムネイル作成
  - キャッシュ戦略

**Month 7: 検索精度向上**
- [ ] 検索ランキング改善
  - 関連度スコアリング
  - ユーザーフィードバック反映
- [ ] 検索サジェスト
  - オートコンプリート
  - 検索履歴活用
- [ ] レコメンド機能
  - よく検索されるファイル
  - 関連ファイル提案

**成果物**
- 画像類似検索機能
- 改善された検索精度
- レコメンド機能

### Phase 4: 運用最適化（1ヶ月）

**期間**: 2025年9月

#### 目標
- パフォーマンスチューニング
- 運用ツール整備
- 本番環境への移行

#### 主要タスク

**Month 8: 本番移行準備**
- [ ] パフォーマンス最適化
  - 負荷テスト実施
  - ボトルネック特定と改善
  - キャッシング戦略最適化
- [ ] 運用ツール
  - 監視ダッシュボード
  - ログ分析ツール
  - 管理画面
- [ ] ドキュメント整備
  - 運用マニュアル
  - ユーザーマニュアル
  - トラブルシューティングガイド
- [ ] 本番移行
  - データ移行
  - ユーザートレーニング
  - 本番リリース

**成果物**
- 本番稼働システム
- 完全なドキュメント一式
- 運用体制確立

## 3. マイルストーン

| マイルストーン | 日付 | 内容 |
|-------------|------|------|
| M1: プロジェクト開始 | 2025/02/01 | キックオフミーティング |
| M2: MVP完成 | 2025/04/30 | 基本機能実装完了 |
| M3: 高度な機能完成 | 2025/06/30 | 全文検索・特殊ファイル対応 |
| M4: AI機能完成 | 2025/08/31 | 画像検索・レコメンド完成 |
| M5: 本番稼働 | 2025/09/30 | 正式リリース |

## 4. リソース計画

### 4.1 チーム構成

| 役割 | 人数 | 責任範囲 |
|------|------|----------|
| プロジェクトマネージャー | 1名 | プロジェクト全体管理 |
| フロントエンドエンジニア | 2名 | UI/UX実装 |
| バックエンドエンジニア | 2名 | API・インフラ構築 |
| QAエンジニア | 1名 | テスト・品質保証 |
| DevOpsエンジニア | 1名 | CI/CD・インフラ管理 |

### 4.2 予算概算

| 項目 | 月額 | 備考 |
|------|------|------|
| AWS利用料 | ¥200,000 | ECS, RDS, OpenSearch |
| 開発ツール | ¥50,000 | GitHub, 監視ツール等 |
| その他 | ¥50,000 | 予備費 |
| **合計** | **¥300,000** | 月額運用コスト |

## 5. リスク管理

### 5.1 技術リスク

| リスク | 影響 | 対策 |
|--------|------|------|
| SFCファイル解析の複雑性 | 高 | 専門ベンダーとの協力体制構築 |
| 検索パフォーマンス | 中 | 早期の負荷テスト実施 |
| AWS コスト超過 | 中 | コスト監視アラート設定 |

### 5.2 スケジュールリスク

| リスク | 影響 | 対策 |
|--------|------|------|
| 要件変更 | 高 | アジャイル開発で柔軟に対応 |
| リソース不足 | 中 | 優先度管理と外部委託検討 |

## 6. 品質基準

### 6.1 品質目標

- **テストカバレッジ**: 80%以上
- **レスポンスタイム**: 検索10秒以内
- **可用性**: 99.5%以上
- **セキュリティ**: 脆弱性スキャン月1回実施

### 6.2 レビュー体制

- **コードレビュー**: 全プルリクエスト必須
- **デザインレビュー**: 週1回実施
- **セキュリティレビュー**: フェーズ終了時

## 7. 継続的改善計画

### 7.1 フィードバック収集

- ユーザーアンケート（月1回）
- 利用ログ分析（週1回）
- バグレポート管理

### 7.2 機能追加候補

- モバイルアプリ開発
- 外部システム連携（Slack、Teams）
- AI自動タグ付け
- 音声検索

## 8. 成功指標（KPI）

### 8.1 利用状況

- **月間アクティブユーザー**: 50名以上
- **1日あたり検索数**: 500回以上
- **検索成功率**: 80%以上

### 8.2 システム指標

- **平均検索時間**: 3秒以内
- **システム稼働率**: 99.5%以上
- **エラー率**: 1%未満

### 8.3 ビジネス指標

- **ファイル検索時間短縮**: 70%削減
- **ユーザー満足度**: 4.0/5.0以上
- **業務効率化**: 月間20時間削減

## 9. 今後の展望

### 9.1 短期（1年以内）

- モバイル対応
- より高度なAI機能
- パフォーマンス最適化

### 9.2 中期（2-3年）

- グローバル展開
- マルチテナント対応
- エンタープライズ機能拡充

### 9.3 長期（3年以上）

- AIによる自動分類・整理
- 予測検索
- 統合情報管理プラットフォーム化

## 10. 月次バッチ最適化版ロードマップ（8週間）

### 10.1 概要

ユースケース分析の結果、**「古いデータの検索」が主要な目的**であることが判明したため、リアルタイム同期ではなく**月次バッチ同期アーキテクチャ**を推奨します。これにより、開発期間を**8ヶ月から8週間（2ヶ月）に短縮**し、運用コストを**年間$840（52%）削減**します。

### 10.2 主要な変更点

| 項目 | 従来計画（8ヶ月） | 月次バッチ最適化（8週間） |
|------|-----------------|----------------------|
| **開発期間** | 8ヶ月 | **8週間** (**75%短縮**) |
| **月額コスト** | ¥30,000 ($200) | **¥6,900 ($46)** (**77%削減**) |
| **データ同期** | リアルタイム | 月1回バッチ同期 |
| **VPN接続** | 常時接続 | 月1回、4時間のみ |
| **初期投資** | 高 | 低（$108のみ） |

### 10.3 週次スプリント計画

#### Week 1-2: インフラ基盤構築

**目標**: AWS基盤をTerraformで構築し、NAS-AWS間のVPN接続とDataSync設定を完了

| タスク | 期限 | 担当 | 完了条件 |
|--------|------|------|---------|
| AWSアカウントセットアップ、Terraform環境構築 | Day 1-2 | DevOps | Terraformでのリソース作成成功 |
| VPNとネットワーク構築 | Day 3-4 | DevOps | VPN接続確立、ping疎通確認 |
| S3、DynamoDB、OpenSearch構築 | Day 5 | DevOps | 全サービスアクセス可能 |
| DataSyncエージェントデプロイ | Day 6-7 | DevOps | エージェント稼働中 |
| DataSyncタスク作成とテスト | Day 8-9 | DevOps | タスク作成完了 |
| Week 1-2完了確認 | Day 10 | PM | すべてのリソース作成完了 |

**成果物**:
- `terraform/` ディレクトリ（完全なIaCコード）
- DataSync Task ARN
- 環境変数ファイル（`.env.production`）

#### Week 3-4: バッチ処理実装

**目標**: Lambda関数を実装し、Step Functionsでバッチ処理を自動化。初回同期を成功させる

| タスク | 期限 | 担当 | 完了条件 |
|--------|------|------|---------|
| Lambda関数の基本実装（TextExtractor） | Day 11-12 | Backend | 関数デプロイ成功 |
| Lambda関数の基本実装（ImageFeatureExtractor） | Day 11-12 | Backend | 関数デプロイ成功 |
| Step Functions実装 | Day 13-14 | Backend | ワークフロー定義完成 |
| ユニットテスト実装 | Day 15 | QA | カバレッジ80%以上 |
| 初回同期実行とデバッグ | Day 16-17 | Backend | 同期成功（500GB転送） |
| エラーハンドリングとリトライ実装 | Day 18-19 | Backend | リトライ戦略実装完了 |
| Week 3-4完了確認 | Day 20 | PM | 初回同期成功、テスト全通過 |

**成果物**:
- Lambda関数（TextExtractor, ImageFeatureExtractor, BulkIndexer）
- Step Functions定義
- ユニットテストスイート

#### Week 5-6: 検索機能実装

**目標**: OpenSearchの設定を完了し、全文検索と画像類似検索APIを実装

| タスク | 期限 | 担当 | 完了条件 |
|--------|------|------|---------|
| OpenSearchインデックス設計と作成 | Day 21-22 | Backend | インデックス作成完了 |
| 検索API実装（全文検索） | Day 23-24 | Backend | API実装完了 |
| 画像類似検索API実装 | Day 25 | Backend | k-NN検索成功 |
| API Gateway設定 | Day 26-27 | Backend | エンドポイント公開 |
| 統合テスト | Day 28-29 | QA | テスト全通過 |
| パフォーマンステスト | Day 30 | QA | レスポンス< 200ms |

**成果物**:
- OpenSearchインデックス
- 全文検索API
- 画像類似検索API
- API Gatewayエンドポイント

#### Week 7-8: 統合テスト・本番デプロイ

**目標**: E2Eテストを実施し、本番環境へデプロイ。ユーザートレーニングを実施

| タスク | 期限 | 担当 | 完了条件 |
|--------|------|------|---------|
| E2Eテスト | Day 31-32 | QA | 全シナリオ通過 |
| セキュリティテスト | Day 33-34 | QA | OWASP ZAP合格 |
| ドキュメント整備 | Day 35 | PM | 運用手順書完成 |
| 本番デプロイ | Day 36-37 | DevOps | デプロイ成功 |
| ユーザートレーニング | Day 38 | PM | トレーニング完了 |
| 本番運用開始 | Day 39 | 全員 | 初回バッチ実行成功 |
| プロジェクト完了レビュー | Day 40 | PM | 全機能テスト合格 |

**成果物**:
- 本番稼働システム
- 運用ドキュメント一式
- ユーザーマニュアル

### 10.4 マイルストーン（8週間版）

| マイルストーン | Week | 完了条件 | 成果物 |
|-------------|------|---------|-------|
| **M1: インフラ基盤完成** | Week 2 | VPN, DataSync, AWS基盤構築完了 | Terraformコード |
| **M2: バッチ処理完成** | Week 4 | 初回同期成功、Lambda実装完了 | 処理パイプライン |
| **M3: 検索機能完成** | Week 6 | 全文検索・画像検索API完成 | 検索API |
| **M4: 本番稼働** | Week 8 | 本番デプロイ、運用開始 | 稼働システム |

### 10.5 予算（月次バッチ最適化版）

#### 初期投資

| 項目 | 金額 | 備考 |
|------|------|------|
| DataSync初回同期 | $62.50 | 500GB転送（1回のみ） |
| テスト環境 | $45.49 | 1ヶ月運用 |
| **合計** | **$107.99** | **¥16,199** (¥150/USD) |

#### 月額運用コスト

| 項目 | 月額（USD） | 月額（JPY） | 備考 |
|------|-----------|-----------|------|
| VPN | $1.20 | ¥180 | 月1回、4時間接続 |
| DataSync | $5.00 | ¥750 | 20GB増分転送 |
| Lambda | $2.50 | ¥375 | バッチ処理 |
| OpenSearch | $31.75 | ¥4,763 | t3.small.search + Storage |
| S3 | $2.28 | ¥342 | Intelligent-Tiering |
| DynamoDB | $1.50 | ¥225 | メタデータ |
| その他 | $2.56 | ¥384 | Step Functions, CloudWatch, SNS |
| **合計** | **$46.79** | **¥7,019** | **従来比 77%削減** |

### 10.6 コスト削減効果（3年間）

| 期間 | 従来計画 | 月次バッチ最適化 | 削減額 |
|------|---------|----------------|-------|
| **Year 1** | ¥3,600,000 | ¥841,428 | **¥2,758,572** |
| **Year 2** | ¥3,600,000 | ¥841,428 | **¥2,758,572** |
| **Year 3** | ¥3,600,000 | ¥841,428 | **¥2,758,572** |
| **3年間合計** | **¥10,800,000** | **¥2,524,284** | **¥8,275,716** (77%) |

### 10.7 リスク管理（月次バッチ版）

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|---------|------|
| DataSync初回同期失敗 | 高 | 中 | 段階的同期、詳細ログ |
| Lambda Timeout | 中 | 高 | メモリ増強、タイムアウト調整 |
| VPN接続不安定 | 高 | 中 | リトライ実装、アラート設定 |
| コスト超過 | 中 | 低 | CloudWatch Billing Alarm設定 |
| データ鮮度要件変更 | 低 | 低 | 週次バッチへの切り替え可能 |

### 10.8 詳細ドキュメント

本ロードマップの詳細は、以下のドキュメントを参照してください:

- **実装ロードマップ詳細**: `/docs/implementation-roadmap-optimized.md`
- **月次バッチアーキテクチャ**: `/docs/architecture-batch-optimized.md`
- **画像類似検索設計**: `/docs/image-similarity-search.md`
- **バッチ同期詳細設計**: `/docs/batch-sync-design.md`
- **コスト最適化分析**: `/docs/cost-optimization-analysis.md`

---

## 改訂履歴

| 版数 | 日付 | 改訂内容 | 作成者 |
|------|------|----------|--------|
| 1.0 | 2025-01-15 | 初版作成 | CIS開発チーム |
| 1.1 | 2025-01-18 | 月次バッチ最適化版ロードマップ追加 | CIS開発チーム |